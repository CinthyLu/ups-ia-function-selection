
# UPS AI Assistant - Function Matching & Predictions

[![FastAPI](https://img.shields.io/badge/FastAPI-Modern%20API-red)](https://fastapi.tiangolo.com/) [![React](https://img.shields.io/badge/React-Frontend-blue)](https://reactjs.org/) [![PostgreSQL](https://img.shields.io/badge/PostgreSQL-Vector%20DB-brightgreen)](https://postgresql.org/) [![Docker](https://img.shields.io/badge/Docker-Container-blue)](https://docker.com/)

**AplicaciÃ³n de IA para consultas universitarias (UPS) con Function Matching inteligente, predicciones de inventario y RAG para FAQs.**

## âœ¨ Â¿QuÃ© hace la app?

### Funcionalidades principales:

1. **Function Matcher (IA)**: Convierte consultas del usuario en llamadas automÃ¡ticas a funciones usando embeddings + KNN (similitud coseno >90%)
2. **Predicciones de inventario**: ML para stock con opciones por producto, fecha o general
3. **Chatbot universitario**: Respuestas sobre admisiones, becas, mallas curriculares
4. **RAG + FAQs**: Retrieval Augmentation con documentos de la universidad
5. **Frontend React**: Interfaz moderna para chat y predicciones

**Ejemplos de consultas que entiende:**
```

"Con quiÃ©n me contacto para admisiones en la UPS"
"CuÃ¡les son los tipos de becas"
"Malla curricular de computaciÃ³n"


```

---

## ğŸš€ Quick Start

### 1. Backend (FastAPI + Postgres)

```bash
# 1. Levantar base de datos
docker compose up -d

# 2. Inicializar Function Matcher (IMPORTANTE)
cd Backend/ai/functionMatcher/
python Initializer.py

# 3. Crear tablas FAQs
cd Backend/db/
python models.py
python Tables.py  # rellena datos

# 4. Configurar API Key (Gemini)
echo 'GOOGLE_GEMINI_API_KEY=tu_api_key_aqui' > .env

# 5. Correr aplicaciÃ³n
python main.py
```

**Backend disponible en:** `http://localhost:8000`

### 2. Frontend (React)

```bash
cd Frontend/
npm install
npm run dev
```

**Frontend disponible en:** `http://localhost:3000`

---

## ğŸ”§ API Endpoints

| Endpoint | DescripciÃ³n | Ejemplo |
| :-- | :-- | :-- |
| `POST /chat` | Chat con function matching | `{"query": "malla de computaciÃ³n"}` |
| `POST /predict/stock` | PredicciÃ³n stock general | `{}` |
| `POST /predict/stock/product/{id}` | Stock por producto | `{}` |
| `POST /predict/stock/date/{date}` | Stock por fecha | `{}` |
| `POST /predict/stock/product-date` | Stock producto + fecha | `{"product_id": 1}` |

**Docs automÃ¡ticos:** `http://localhost:8000/docs`

---

## ğŸ—ï¸ Arquitectura

```
Usuario â†’ React Frontend â†’ FastAPI Backend
                    â†“
            Function Matcher (KNN + Embeddings)
                    â†“
        Predicciones ML / RAG / FAQs / Gemini
                    â†“
             PostgreSQL (vectores + datos)
```

**TecnologÃ­as:**

- **Backend**: FastAPI, PostgreSQL (vectores), Gemini LLM
- **IA**: Sentence Transformers, scikit-learn (KNN), embeddings
- **Frontend**: React, TypeScript
- **Infra**: Docker Compose

---

## ğŸ“Š Function Matching (cÃ³mo funciona)

1. **Query** â†’ Embedding
2. **ComparaciÃ³n** con descripciones de funciones (similitud coseno)
3. **SelecciÃ³n** funciÃ³n mÃ¡s cercana (>90% confianza)
4. **EjecuciÃ³n** y respuesta natural

**Ejemplo:**

```
Query: "becas UPS"
â†’ Selecciona: fn_tipos_becas()
â†’ Respuesta: "Becas 30%, 40%, 50%"
```


---

## ğŸ”„ Comandos Ãºtiles

```bash
# Reentrenar matcher
python Backend/ai/functionMatcher/retrain.py

# Reiniciar todo
docker compose down -v && docker compose up -d
cd Backend/ai/functionMatcher/ && python Initializer.py
```


---

<!-- ## ğŸš§ TODO (Pendiente)

- âœ… Function Matching (embeddings + KNN)
- âœ… Predicciones stock (todas las variantes)
- âœ… RAG para FAQs
- âœ… Carga CSV productos
- â³ **Extraer parÃ¡metros SQL en matcher** (routes.py ln 140)
- â³ **Reentrenamiento dinÃ¡mico**
- â³ **Productos mÃ¡s/menos vendidos**
- â³ **Reportes CSV/Excel** -->

---

## ğŸ› ï¸ Desarrollo

### Dependencias Backend

```bash
pip install -r Backend/requirements.txt
```


### Dependencias Frontend

```bash
cd Frontend/ && npm install
```


### Agregar nueva funciÃ³n

1. `Backend/ai/functionMatcher/functions.py` â†’ nueva funciÃ³n
2. `matching.py` â†’ agregar al `FUNCTION_CATALOG`
3. `python Initializer.py` â†’ reentrenar

---

## ğŸ“± Testing

**Probar chat:**

```bash
curl -X POST "http://localhost:8000/chat" \
  -H "Content-Type: application/json" \
  -d '{"query": "malla curricular de arquitectura"}'
```

**Ver similitudes (debug):**
El endpoint `/chat` devuelve `function` y `similarity`.

---


